<div class="docbook"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">D.3. Examples</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="apds02.html">Prev</a> </td><th width="60%" align="center">Appendix D. Statistics Reporting</th><td width="20%" align="right"> <a accesskey="n" href="Java-Broker-Appendix-Queue-Alerts.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d0e13018"></a>D.3. Examples</h2></div></div></div><p>Adding a statistic reporting pattern to a single queue, called <code class="literal">myqueue</code> using the REST API and
      cURL.  This example uses <code class="literal">ancestor</code> references to include entity names:</p><div class="example"><a id="d0e13029"></a><p class="title"><strong>Example D.1. Enabling statistics for a single queue using the REST API and cURL</strong></p><div class="example-contents"><pre class="screen">curl --user admin --data '{"name" : "qpid.queue.statisticsReportPattern",
"value" : "${ancestor:virtualhost:name}/${ancestor:queue:name}: queueDepthMessages=${queueDepthMessages},
queueDepthBytes=${queueDepthBytes:byteunit}"}' https://localhost:8080/api/latest/queue/default/default/myqueue/setContextVariable</pre></div></div><br class="example-break" /><p>
      Once enabled, an example statistic report output written to the log might look like this:
      </p><pre class="screen">INFO  [virtualhost-default-pool-0] (q.s.Queue)- Statistics: default/myqueue: queueDepthMessages=0, queueDepthBytes=0 B
 INFO  [virtualhost-default-pool-2] (q.s.Queue)- Statistics: default/myqueue: queueDepthMessages=3, queueDepthBytes=345 B
 INFO  [virtualhost-default-pool-2] (q.s.Queue)- Statistics: default/myqueue: queueDepthMessages=3, queueDepthBytes=345 B</pre><p>
    </p><p>Removing a statistic report pattern from the same queue:</p><div class="example"><a id="d0e13041"></a><p class="title"><strong>Example D.2. Disabling statistics for a single queue using the REST API and cURL</strong></p><div class="example-contents"><pre class="screen">
curl --user admin --data '{"name" : "qpid.queue.statisticsReportPattern"}' https://localhost:8080/api/latest/queue/default/default/myqueue/setContextVariable</pre></div></div><br class="example-break" /><p>Adding a statistic reporting pattern to all queues:</p><div class="example"><a id="d0e13048"></a><p class="title"><strong>Example D.3. Enabling statistics for all queues using the REST API and cURL</strong></p><div class="example-contents"><pre class="screen">curl --user admin --data '{"name" : "qpid.queue.statisticsReportPattern",
"value" : "${ancestor:virtualhost:name}/${ancestor:queue:name}:
oldestMessageAge=${oldestMessageAge:duration}"}' https://localhost:8080/api/latest/virtualhost/default/default/setContextVariable</pre></div></div><br class="example-break" /><p>
      Once enabled, an  example statistic report for a virtualhost with two queues might look like this:
      </p><pre class="screen">INFO  [virtualhost-default-pool-1] (q.s.Queue)- Statistics: default/myqueue1: oldestMessageAge=PT1M24S
      INFO  [virtualhost-default-pool-1] (q.s.Queue)- Statistics: default/myqueue2: oldestMessageAge=PT0S</pre><p>
    </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="apds02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="Java-Broker-Appendix-Statistics-Reporting.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="Java-Broker-Appendix-Queue-Alerts.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">D.2. Statistic Report Patterns </td><td width="20%" align="center"><a accesskey="h" href="Apache-Qpid-Broker-J-Book.html">Home</a></td><td width="40%" align="right" valign="top"> Appendix E. Queue Alerts</td></tr></table></div></div>