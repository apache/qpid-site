<div class="docbook"><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3">D.3.&#160;Examples</th></tr><tr><td align="left" width="20%"><a accesskey="p" href="apds02.html">Prev</a>&#160;</td><th align="center" width="60%">Appendix&#160;D.&#160;Statistics Reporting</th><td align="right" width="20%">&#160;<a accesskey="n" href="Java-Broker-Appendix-Queue-Alerts.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d0e9548"></a>D.3.&#160;Examples</h2></div></div></div><p>Adding a statistic reporting pattern to a single queue, called <code class="literal">myqueue</code> using the REST API and
      cURL.  This example uses <code class="literal">ancestor</code> references to include entity names:</p><div class="example"><a id="d0e9559"></a><p class="title"><strong>Example&#160;D.1.&#160;Enabling statistics for a single queue using the REST API and cURL</strong></p><div class="example-contents"><pre class="screen">curl --user admin --data '{"name" : "qpid.queue.statisticsReportPattern", "value" : "${ancestor:virtualhost:name}/${ancestor:queue:name}: queueDepthMessages=${queueDepthMessages}, queueDepthBytes=${queueDepthBytes:byteunit}"}' https://localhost:8080/api/latest/queue/default/default/myqueue/setContextVariable</pre></div></div><br class="example-break" /><p>
      Once enabled, an example statistic report output written to the log might look like this:
      </p><pre class="screen">2017-10-15 13:03:12,993 INFO  [virtualhost-default-pool-0] (q.s.Queue) - Statistics: default/myqueue: queueDepthMessages=0, queueDepthBytes=0 B
2017-10-15 13:03:22,979 INFO  [virtualhost-default-pool-2] (q.s.Queue) - Statistics: default/myqueue: queueDepthMessages=3, queueDepthBytes=345 B
2017-10-15 13:03:32,981 INFO  [virtualhost-default-pool-2] (q.s.Queue) - Statistics: default/myqueue: queueDepthMessages=3, queueDepthBytes=345 B</pre><p>
    </p><p>Removing a statistic report pattern from the same queue:</p><div class="example"><a id="d0e9571"></a><p class="title"><strong>Example&#160;D.2.&#160;Disabling statistics for a single queue using the REST API and cURL</strong></p><div class="example-contents"><pre class="screen">curl --user admin --data '{"name" : "qpid.queue.statisticsReportPattern"}' https://localhost:8080/api/latest/queue/default/default/myqueue/setContextVariable</pre></div></div><br class="example-break" /><p>Adding a statistic reporting pattern to all queues:</p><div class="example"><a id="d0e9578"></a><p class="title"><strong>Example&#160;D.3.&#160;Enabling statistics for all queues using the REST API and cURL</strong></p><div class="example-contents"><pre class="screen">curl --user admin --data '{"name" : "qpid.queue.statisticsReportPattern", "value" : "${ancestor:virtualhost:name}/${ancestor:queue:name}: oldestMessageAge=${oldestMessageAge:duration}"}' https://localhost:8080/api/latest/virtualhost/default/default/setContextVariable</pre></div></div><br class="example-break" /><p>
      Once enabled, an  example statistic report for a virtualhost with two queues might look like this:
      </p><pre class="screen">2017-10-15 13:17:42,918 INFO  [virtualhost-default-pool-1] (q.s.Queue) - Statistics: default/myqueue1: oldestMessageAge=PT1M24S
2017-10-15 13:17:42,918 INFO  [virtualhost-default-pool-1] (q.s.Queue) - Statistics: default/myqueue2: oldestMessageAge=PT0S</pre><p>
    </p></div><div class="navfooter"><hr /><table summary="Navigation footer" width="100%"><tr><td align="left" width="40%"><a accesskey="p" href="apds02.html">Prev</a>&#160;</td><td align="center" width="20%"><a accesskey="u" href="Java-Broker-Appendix-Statistics-Reporting.html">Up</a></td><td align="right" width="40%">&#160;<a accesskey="n" href="Java-Broker-Appendix-Queue-Alerts.html">Next</a></td></tr><tr><td align="left" valign="top" width="40%">D.2.&#160;Statistic Report Patterns&#160;</td><td align="center" width="20%"><a accesskey="h" href="Apache-Qpid-Broker-J-Book.html">Home</a></td><td align="right" valign="top" width="40%">&#160;Appendix&#160;E.&#160;Queue Alerts</td></tr></table></div></div>