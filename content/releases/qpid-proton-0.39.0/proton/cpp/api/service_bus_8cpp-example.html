<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Qpid Proton C++ API: service_bus.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Qpid Proton C++ API<span id="projectnumber">&#160;0.39.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('service_bus_8cpp-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">service_bus.cpp</div></div>
</div><!--header-->
<div class="contents">
<p >A working example for accessing Service Bus session-enabled queues.</p>
<p >A working example for accessing Service Bus session-enabled queues.Also provides some general notes on Service Bus usage.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Licensed to the Apache Software Foundation (ASF) under one</span></div>
<div class="line"><span class="comment"> * or more contributor license agreements.  See the NOTICE file</span></div>
<div class="line"><span class="comment"> * distributed with this work for additional information</span></div>
<div class="line"><span class="comment"> * regarding copyright ownership.  The ASF licenses this file</span></div>
<div class="line"><span class="comment"> * to you under the Apache License, Version 2.0 (the</span></div>
<div class="line"><span class="comment"> * &quot;License&quot;); you may not use this file except in compliance</span></div>
<div class="line"><span class="comment"> * with the License.  You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Unless required by applicable law or agreed to in writing,</span></div>
<div class="line"><span class="comment"> * software distributed under the License is distributed on an</span></div>
<div class="line"><span class="comment"> * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span></div>
<div class="line"><span class="comment"> * KIND, either express or implied.  See the License for the</span></div>
<div class="line"><span class="comment"> * specific language governing permissions and limitations</span></div>
<div class="line"><span class="comment"> * under the License.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Service Bus example.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This is an example of using &quot;Service Bus sessions&quot; (not the same thing as an</span></div>
<div class="line"><span class="comment"> * AMQP session) to selectively retrieve messages from a queue.  The queue must</span></div>
<div class="line"><span class="comment"> * be configured within Service Bus to support sessions.  Service Bus uses the</span></div>
<div class="line"><span class="comment"> * AMQP group_id message property to associate messages with a particular</span></div>
<div class="line"><span class="comment"> * Service Bus session.  It uses AMQP filters to specify which session is</span></div>
<div class="line"><span class="comment"> * associated with a receiver.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The mechanics for sending and receiving to other types of service bus queue</span></div>
<div class="line"><span class="comment"> * are broadly the same, as long as the step using the</span></div>
<div class="line"><span class="comment"> * receiver.source().filters() is omitted.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Other Service Bus notes: There is no drain support, hence the need to to use</span></div>
<div class="line"><span class="comment"> * timeouts in this example to detect the end of the message stream.  There is</span></div>
<div class="line"><span class="comment"> * no browse support when setting the AMQP link distribution mode to COPY.</span></div>
<div class="line"><span class="comment"> * Service Bus claims to support browsing, but it is unclear how to manage that</span></div>
<div class="line"><span class="comment"> * with an AMQP client.  Maximum message sizes (for body and headers) vary</span></div>
<div class="line"><span class="comment"> * between queue types and fee tier ranging from 64KB to 1MB.  Due to the</span></div>
<div class="line"><span class="comment"> * distributed nature of Service Bus, queues do not automatically preserve FIFO</span></div>
<div class="line"><span class="comment"> * order of messages unless the user takes steps to force the message stream to</span></div>
<div class="line"><span class="comment"> * a single partition of the queue or creates the queue with partitioning disabled.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This example shows use of the simpler SAS (Shared Access Signature)</span></div>
<div class="line"><span class="comment"> * authentication scheme where the credentials are supplied on the connection.</span></div>
<div class="line"><span class="comment"> * Service Bus does not actually check these credentials when setting up the</span></div>
<div class="line"><span class="comment"> * connection, it merely caches the SAS key and policy (AKA key name) for later</span></div>
<div class="line"><span class="comment"> * access authorization when creating senders and receivers.  There is a second</span></div>
<div class="line"><span class="comment"> * authentication scheme that allows for multiple tokens and even updating them</span></div>
<div class="line"><span class="comment"> * within a long-lived connection which uses special management request-response</span></div>
<div class="line"><span class="comment"> * queues in Service Bus.  The format of this exchange may be documented</span></div>
<div class="line"><span class="comment"> * somewhere but is also available by working through the CbsAsyncExample.cs</span></div>
<div class="line"><span class="comment"> * program in the Amqp.Net Lite project.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The sample output for this program is:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   sent message: message 0 in service bus session &quot;red&quot;</span></div>
<div class="line"><span class="comment">   sent message: message 1 in service bus session &quot;green&quot;</span></div>
<div class="line"><span class="comment">   sent message: message 2 in service bus session &quot;blue&quot;</span></div>
<div class="line"><span class="comment">   sent message: message 3 in service bus session &quot;red&quot;</span></div>
<div class="line"><span class="comment">   sent message: message 4 in service bus session &quot;black&quot;</span></div>
<div class="line"><span class="comment">   sent message: message 5 in service bus session &quot;blue&quot;</span></div>
<div class="line"><span class="comment">   sent message: message 6 in service bus session &quot;yellow&quot;</span></div>
<div class="line"><span class="comment">receiving messages with session identifier &quot;green&quot; from queue ses_q1</span></div>
<div class="line"><span class="comment">   received message: message 1 in service bus session &quot;green&quot;</span></div>
<div class="line"><span class="comment">receiving messages with session identifier &quot;red&quot; from queue ses_q1</span></div>
<div class="line"><span class="comment">   received message: message 0 in service bus session &quot;red&quot;</span></div>
<div class="line"><span class="comment">   received message: message 3 in service bus session &quot;red&quot;</span></div>
<div class="line"><span class="comment">receiving messages with session identifier &quot;blue&quot; from queue ses_q1</span></div>
<div class="line"><span class="comment">   received message: message 2 in service bus session &quot;blue&quot;</span></div>
<div class="line"><span class="comment">   received message: message 5 in service bus session &quot;blue&quot;</span></div>
<div class="line"><span class="comment">receiving messages with session identifier &quot;black&quot; from queue ses_q1</span></div>
<div class="line"><span class="comment">   received message: message 4 in service bus session &quot;black&quot;</span></div>
<div class="line"><span class="comment">receiving messages with session identifier &quot;yellow&quot; from queue ses_q1</span></div>
<div class="line"><span class="comment">   received message: message 6 in service bus session &quot;yellow&quot;</span></div>
<div class="line"><span class="comment">Done. No more messages.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;options.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="connection_8hpp.html">proton/connection.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="connection__options_8hpp.html">proton/connection_options.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="container_8hpp.html">proton/container.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="delivery_8hpp.html">proton/delivery.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="message_8hpp.html">proton/message.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="messaging__handler_8hpp.html">proton/messaging_handler.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="receiver__options_8hpp.html">proton/receiver_options.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ssl_8hpp.html">proton/ssl.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sender_8hpp.html">proton/sender.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sender__options_8hpp.html">proton/sender_options.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="source__options_8hpp.html">proton/source_options.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="tracker_8hpp.html">proton/tracker.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="work__queue_8hpp.html">proton/work_queue.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a id="_a0" name="_a0"></a><a class="code hl_class" href="classproton_1_1source__options.html">proton::source_options</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a1" name="_a1"></a><a class="code hl_class" href="classproton_1_1connection__options.html">proton::connection_options</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a2" name="_a2"></a><a class="code hl_class" href="classproton_1_1sender__options.html">proton::sender_options</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a3" name="_a3"></a><a class="code hl_class" href="classproton_1_1receiver__options.html">proton::receiver_options</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a4" name="_a4"></a><a class="code hl_class" href="classproton_1_1ssl__client__options.html">proton::ssl_client_options</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> do_next_sequence();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>{</div>
<div class="line"><span class="keywordtype">void</span> check_arg(<span class="keyword">const</span> std::string &amp;value, <span class="keyword">const</span> std::string &amp;name) {</div>
<div class="line">    <span class="keywordflow">if</span> (value.empty())</div>
<div class="line">        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;missing argument for \&quot;&quot;</span> + name + <span class="stringliteral">&quot;\&quot;&quot;</span>);</div>
<div class="line">}</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>session_receiver : <span class="keyword">public</span> <a id="_a5" name="_a5"></a><a class="code hl_class" href="classproton_1_1messaging__handler.html">proton::messaging_handler</a> {</div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">const</span> std::string &amp;connection_url;</div>
<div class="line">    <span class="keyword">const</span> std::string &amp;entity;</div>
<div class="line">    connection_options coptions;</div>
<div class="line">    <a id="_a6" name="_a6"></a><a class="code hl_class" href="classproton_1_1value.html">proton::value</a> session_identifier; <span class="comment">// AMQP null type by default, matches any Service Bus sequence identifier</span></div>
<div class="line">    <span class="keywordtype">int</span> message_count;</div>
<div class="line">    <span class="keywordtype">bool</span> closed;</div>
<div class="line">    <a id="_a7" name="_a7"></a><a class="code hl_class" href="classproton_1_1duration.html">proton::duration</a> read_timeout;</div>
<div class="line">    <a id="_a8" name="_a8"></a><a class="code hl_class" href="classproton_1_1timestamp.html">proton::timestamp</a> last_read;</div>
<div class="line">    <a id="_a9" name="_a9"></a><a class="code hl_class" href="classproton_1_1container.html">proton::container</a> *container;</div>
<div class="line">    <a id="_a10" name="_a10"></a><a class="code hl_class" href="classproton_1_1receiver.html">proton::receiver</a> receiver;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    session_receiver(<span class="keyword">const</span> std::string &amp;c, <span class="keyword">const</span> std::string &amp;e, <span class="keyword">const</span> connection_options &amp;co,</div>
<div class="line">                     <span class="keyword">const</span> <span class="keywordtype">char</span> *sid) :</div>
<div class="line">        connection_url(c), entity(e), coptions(co),</div>
<div class="line">        message_count(0), closed(false), read_timeout(5000), last_read(0), container(0) {</div>
<div class="line">        <span class="keywordflow">if</span> (sid)</div>
<div class="line">            session_identifier = std::string(sid);</div>
<div class="line">        <span class="comment">// session_identifier is now either empty/null or an AMQP string type.</span></div>
<div class="line">        <span class="comment">// If null, Service Bus will pick the first available message and create</span></div>
<div class="line">        <span class="comment">// a filter at its end with that message&#39;s session identifier.</span></div>
<div class="line">        <span class="comment">// Technically, an AMQP string is not a valid filter-set value unless it</span></div>
<div class="line">        <span class="comment">// is annotated as an AMQP described type, so this may change.</span></div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> run (<a class="code hl_class" href="classproton_1_1container.html">proton::container</a> &amp;c) {</div>
<div class="line">        message_count = 0;</div>
<div class="line">        closed = <span class="keyword">false</span>;</div>
<div class="line">        c.<a id="a11" name="a11"></a><a class="code hl_function" href="classproton_1_1container.html#afc1b194266160cf854c5cbb8eeab4219">connect</a>(connection_url, coptions.handler(*<span class="keyword">this</span>));</div>
<div class="line">        container = &amp;c;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a id="a12" name="a12"></a><a class="code hl_function" href="classproton_1_1messaging__handler.html#a41277abe0e33a3df2764b08dcc12d768">on_connection_open</a>(<a id="_a13" name="_a13"></a><a class="code hl_class" href="classproton_1_1connection.html">proton::connection</a> &amp;connection)<span class="keyword"> override </span>{</div>
<div class="line">        <a id="_a14" name="_a14"></a><a class="code hl_class" href="classproton_1_1map.html">proton::source::filter_map</a> sb_filter_map;</div>
<div class="line">        <a id="_a15" name="_a15"></a><a class="code hl_class" href="classproton_1_1symbol.html">proton::symbol</a> key(<span class="stringliteral">&quot;com.microsoft:session-filter&quot;</span>);</div>
<div class="line">        sb_filter_map.<a id="a16" name="a16"></a><a class="code hl_function" href="classproton_1_1map.html#ac310ae7d64b7ad8a70b200c07a55a736">put</a>(key, session_identifier);</div>
<div class="line">        receiver = connection.<a id="a17" name="a17"></a><a class="code hl_function" href="classproton_1_1connection.html#aad60d14592ee9d34caca4c61214ecd27">open_receiver</a>(entity, receiver_options().source(source_options().filters(sb_filter_map)));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Start timeout processing here.  If Service Bus has no pending</span></div>
<div class="line">        <span class="comment">// messages, it may defer completing the receiver open until a message</span></div>
<div class="line">        <span class="comment">// becomes available (e.g. to be able to set the actual session</span></div>
<div class="line">        <span class="comment">// identifier if none was specified).</span></div>
<div class="line">        last_read = <a id="a18" name="a18"></a><a class="code hl_function" href="classproton_1_1timestamp.html#a8a432817c74685a518a08ede48d1db34">proton::timestamp::now</a>();</div>
<div class="line">        <span class="comment">// Call this-&gt;process_timeout after read_timeout.</span></div>
<div class="line">        connection.<a id="a19" name="a19"></a><a class="code hl_function" href="classproton_1_1connection.html#a9cabc5284b3663af85c596e36669df15">work_queue</a>().<a id="a20" name="a20"></a><a class="code hl_function" href="classproton_1_1work__queue.html#a214d82f5924296d6fddbb8b150f8b601">schedule</a>(read_timeout, [<span class="keyword">this</span>]() { this-&gt;process_timeout(); });</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a id="a21" name="a21"></a><a class="code hl_function" href="classproton_1_1messaging__handler.html#a77f7e38659ee43ccb764e417ad6dd401">on_receiver_open</a>(<a class="code hl_class" href="classproton_1_1receiver.html">proton::receiver</a> &amp;r)<span class="keyword"> override </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (closed) <span class="keywordflow">return</span>; <span class="comment">// PROTON-1264</span></div>
<div class="line">        <a class="code hl_class" href="classproton_1_1value.html">proton::value</a> actual_session_id = r.<a id="a22" name="a22"></a><a class="code hl_function" href="classproton_1_1receiver.html#a91a9e8a9445b29d83dd0514cd76503ae">source</a>().<a id="a23" name="a23"></a><a class="code hl_function" href="classproton_1_1source.html#af0e7ab5c3f8afb151ab76120a9607a22">filters</a>().<a id="a24" name="a24"></a><a class="code hl_function" href="classproton_1_1map.html#aa5c42da16d5df4154dc8af4c39fbd8e0">get</a>(<span class="stringliteral">&quot;com.microsoft:session-filter&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;receiving messages with session identifier \&quot;&quot;</span> &lt;&lt; actual_session_id</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;\&quot; from queue &quot;</span> &lt;&lt; entity &lt;&lt; std::endl;</div>
<div class="line">        last_read = <a class="code hl_function" href="classproton_1_1timestamp.html#a8a432817c74685a518a08ede48d1db34">proton::timestamp::now</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a id="a25" name="a25"></a><a class="code hl_function" href="classproton_1_1messaging__handler.html#a584c9daeadf4322801f58e054017fecb">on_message</a>(<a id="_a26" name="_a26"></a><a class="code hl_class" href="classproton_1_1delivery.html">proton::delivery</a> &amp;, <a id="_a27" name="_a27"></a><a class="code hl_class" href="classproton_1_1message.html">proton::message</a> &amp;m)<span class="keyword"> override </span>{</div>
<div class="line">        message_count++;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;   received message: &quot;</span> &lt;&lt; m.<a id="a28" name="a28"></a><a class="code hl_function" href="classproton_1_1message.html#ae9af642f154a68ec0eb8e715ecaf95ae">body</a>() &lt;&lt; std::endl;</div>
<div class="line">        last_read = <a class="code hl_function" href="classproton_1_1timestamp.html#a8a432817c74685a518a08ede48d1db34">proton::timestamp::now</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> process_timeout() {</div>
<div class="line">        <a class="code hl_class" href="classproton_1_1timestamp.html">proton::timestamp</a> deadline = last_read + read_timeout;</div>
<div class="line">        <a class="code hl_class" href="classproton_1_1timestamp.html">proton::timestamp</a> now = <a class="code hl_function" href="classproton_1_1timestamp.html#a8a432817c74685a518a08ede48d1db34">proton::timestamp::now</a>();</div>
<div class="line">        <span class="keywordflow">if</span> (now &gt;= deadline) {</div>
<div class="line">            receiver.<a id="a29" name="a29"></a><a class="code hl_function" href="classproton_1_1link.html#a5ae591df94fc66ccb85cbb6565368bca">close</a>();</div>
<div class="line">            closed = <span class="keyword">true</span>;</div>
<div class="line">            receiver.<a id="a30" name="a30"></a><a class="code hl_function" href="classproton_1_1link.html#aff302bb6016f2ae29f01bb4e07389a52">connection</a>().<a id="a31" name="a31"></a><a class="code hl_function" href="classproton_1_1connection.html#a5ae591df94fc66ccb85cbb6565368bca">close</a>();</div>
<div class="line">            <span class="keywordflow">if</span> (message_count)</div>
<div class="line">                do_next_sequence();</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Done. No more messages.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <a class="code hl_class" href="classproton_1_1duration.html">proton::duration</a> next = deadline - now;</div>
<div class="line">            receiver.<a id="a32" name="a32"></a><a class="code hl_function" href="classproton_1_1link.html#a9cabc5284b3663af85c596e36669df15">work_queue</a>().<a class="code hl_function" href="classproton_1_1work__queue.html#a214d82f5924296d6fddbb8b150f8b601">schedule</a>(next, [<span class="keyword">this</span>]() { this-&gt;process_timeout(); });</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>session_sender : <span class="keyword">public</span> <a class="code hl_class" href="classproton_1_1messaging__handler.html">proton::messaging_handler</a> {</div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">const</span> std::string &amp;connection_url;</div>
<div class="line">    <span class="keyword">const</span> std::string &amp;entity;</div>
<div class="line">    connection_options coptions;</div>
<div class="line">    <span class="keywordtype">int</span> msg_count;</div>
<div class="line">    <span class="keywordtype">int</span> total;</div>
<div class="line">    <span class="keywordtype">int</span> accepts;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    session_sender(<span class="keyword">const</span> std::string &amp;c, <span class="keyword">const</span> std::string &amp;e, <span class="keyword">const</span> connection_options &amp;co) :</div>
<div class="line">        connection_url(c), entity(e), coptions(co),</div>
<div class="line">        msg_count(0), total(7), accepts(0) {}</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> run(<a class="code hl_class" href="classproton_1_1container.html">proton::container</a> &amp;c) {</div>
<div class="line">        c.<a id="a33" name="a33"></a><a class="code hl_function" href="classproton_1_1container.html#a80a4c60eeadcd79041a19b5133af0cff">open_sender</a>(connection_url + <span class="stringliteral">&quot;/&quot;</span> + entity, sender_options(), coptions.handler(*<span class="keyword">this</span>));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> send_remaining_messages(<a id="_a34" name="_a34"></a><a class="code hl_class" href="classproton_1_1sender.html">proton::sender</a> &amp;s) {</div>
<div class="line">        std::string gid;</div>
<div class="line">        <span class="keywordflow">for</span> (; msg_count &lt; total &amp;&amp; s.<a id="a35" name="a35"></a><a class="code hl_function" href="classproton_1_1link.html#afd27bd11ba72d7df51c44f71b15749eb">credit</a>() &gt; 0; msg_count++) {</div>
<div class="line">            <span class="keywordflow">switch</span> (msg_count) {</div>
<div class="line">            <span class="keywordflow">case</span> 0: gid = <span class="stringliteral">&quot;red&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 1: gid = <span class="stringliteral">&quot;green&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 2: gid = <span class="stringliteral">&quot;blue&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 3: gid = <span class="stringliteral">&quot;red&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 4: gid = <span class="stringliteral">&quot;black&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 5: gid = <span class="stringliteral">&quot;blue&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 6: gid = <span class="stringliteral">&quot;yellow&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            std::ostringstream mbody;</div>
<div class="line">            mbody &lt;&lt; <span class="stringliteral">&quot;message &quot;</span> &lt;&lt; msg_count &lt;&lt; <span class="stringliteral">&quot; in service bus session \&quot;&quot;</span> &lt;&lt; gid &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line">            <a class="code hl_class" href="classproton_1_1message.html">proton::message</a> m(mbody.str());</div>
<div class="line">            m.<a id="a36" name="a36"></a><a class="code hl_function" href="classproton_1_1message.html#ac203a412f35c34fce9de3016a9d57fb4">group_id</a>(gid);  <span class="comment">// Service Bus uses the group_id property to as the session identifier.</span></div>
<div class="line">            s.<a id="a37" name="a37"></a><a class="code hl_function" href="classproton_1_1sender.html#a214eb30b24e6831d016a47b9dddda830">send</a>(m);</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;   sent message: &quot;</span> &lt;&lt; m.<a class="code hl_function" href="classproton_1_1message.html#ae9af642f154a68ec0eb8e715ecaf95ae">body</a>() &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a id="a38" name="a38"></a><a class="code hl_function" href="classproton_1_1messaging__handler.html#a86c9509ba3ce1925150c5b7a9a937c94">on_sendable</a>(<a class="code hl_class" href="classproton_1_1sender.html">proton::sender</a> &amp;s)<span class="keyword"> override </span>{</div>
<div class="line">        send_remaining_messages(s);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a id="a39" name="a39"></a><a class="code hl_function" href="classproton_1_1messaging__handler.html#a4e61812588fe6fbde253b41f7c02e993">on_tracker_accept</a>(<a id="_a40" name="_a40"></a><a class="code hl_class" href="classproton_1_1tracker.html">proton::tracker</a> &amp;t)<span class="keyword"> override </span>{</div>
<div class="line">        accepts++;</div>
<div class="line">        <span class="keywordflow">if</span> (accepts == total) {</div>
<div class="line">            <span class="comment">// upload complete</span></div>
<div class="line">            t.<a id="a41" name="a41"></a><a class="code hl_function" href="classproton_1_1tracker.html#af6557049c84db2e028dce1b646d2e379">sender</a>().<a class="code hl_function" href="classproton_1_1link.html#a5ae591df94fc66ccb85cbb6565368bca">close</a>();</div>
<div class="line">            t.<a class="code hl_function" href="classproton_1_1tracker.html#af6557049c84db2e028dce1b646d2e379">sender</a>().<a class="code hl_function" href="classproton_1_1link.html#aff302bb6016f2ae29f01bb4e07389a52">connection</a>().<a class="code hl_function" href="classproton_1_1connection.html#a5ae591df94fc66ccb85cbb6565368bca">close</a>();</div>
<div class="line">            do_next_sequence();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>sequence : <span class="keyword">public</span> <a class="code hl_class" href="classproton_1_1messaging__handler.html">proton::messaging_handler</a> {</div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classproton_1_1container.html">proton::container</a> *container;</div>
<div class="line">    <span class="keywordtype">int</span> sequence_no;</div>
<div class="line">    session_sender snd;</div>
<div class="line">    session_receiver rcv_red, rcv_green, rcv_null;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> sequence *the_sequence;</div>
<div class="line"> </div>
<div class="line">    sequence (<span class="keyword">const</span> std::string &amp;c, <span class="keyword">const</span> std::string &amp;e, <span class="keyword">const</span> connection_options &amp;co) :</div>
<div class="line">        container(0), sequence_no(0),</div>
<div class="line">        snd(c, e, co), rcv_red(c, e, co, <span class="stringliteral">&quot;red&quot;</span>), rcv_green(c, e, co, <span class="stringliteral">&quot;green&quot;</span>), rcv_null(c, e, co, NULL) {</div>
<div class="line">        the_sequence = <span class="keyword">this</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> on_container_start(<a class="code hl_class" href="classproton_1_1container.html">proton::container</a> &amp;c)<span class="keyword"> override </span>{</div>
<div class="line">        container = &amp;c;</div>
<div class="line">        next_sequence();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> next_sequence() {</div>
<div class="line">        <span class="keywordflow">switch</span> (sequence_no++) {</div>
<div class="line">        <span class="comment">// run these in order exactly once</span></div>
<div class="line">        <span class="keywordflow">case</span> 0: snd.run(*container); <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 1: rcv_green.run(*container); <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 2: rcv_red.run(*container); <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="comment">// Run this until the receiver decides there is no messages left to sequence through</span></div>
<div class="line">        <span class="keywordflow">default</span>: rcv_null.run(*container); <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">sequence *sequence::the_sequence = NULL;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> do_next_sequence() { sequence::the_sequence-&gt;next_sequence(); }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">    std::string sb_namespace; <span class="comment">// i.e. &quot;foo.servicebus.windows.net&quot;</span></div>
<div class="line">    std::string sb_key_name;  <span class="comment">// shared access key name for entity (AKA &quot;Policy Name&quot;)</span></div>
<div class="line">    std::string sb_key;       <span class="comment">// shared access key</span></div>
<div class="line">    std::string sb_entity;    <span class="comment">// AKA the service bus queue.  Must enable</span></div>
<div class="line">                              <span class="comment">// sessions on it for this example.</span></div>
<div class="line"> </div>
<div class="line">    example::options opts(argc, argv);</div>
<div class="line">    opts.add_value(sb_namespace, <span class="charliteral">&#39;n&#39;</span>, <span class="stringliteral">&quot;namespace&quot;</span>, <span class="stringliteral">&quot;Service Bus full namespace&quot;</span>, <span class="stringliteral">&quot;NAMESPACE&quot;</span>);</div>
<div class="line">    opts.add_value(sb_key_name, <span class="charliteral">&#39;p&#39;</span>, <span class="stringliteral">&quot;policy&quot;</span>, <span class="stringliteral">&quot;policy name that specifies access rights (key name)&quot;</span>, <span class="stringliteral">&quot;POLICY&quot;</span>);</div>
<div class="line">    opts.add_value(sb_key, <span class="charliteral">&#39;k&#39;</span>, <span class="stringliteral">&quot;key&quot;</span>, <span class="stringliteral">&quot;secret key for the policy&quot;</span>, <span class="stringliteral">&quot;key&quot;</span>);</div>
<div class="line">    opts.add_value(sb_entity, <span class="charliteral">&#39;e&#39;</span>, <span class="stringliteral">&quot;entity&quot;</span>, <span class="stringliteral">&quot;entity path (queue name)&quot;</span>, <span class="stringliteral">&quot;ENTITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        opts.parse();</div>
<div class="line">        check_arg(sb_namespace, <span class="stringliteral">&quot;namespace&quot;</span>);</div>
<div class="line">        check_arg(sb_key_name, <span class="stringliteral">&quot;policy&quot;</span>);</div>
<div class="line">        check_arg(sb_key, <span class="stringliteral">&quot;key&quot;</span>);</div>
<div class="line">        check_arg(sb_entity, <span class="stringliteral">&quot;entity&quot;</span>);</div>
<div class="line">        std::string connection_string(<span class="stringliteral">&quot;amqps://&quot;</span> + sb_namespace);</div>
<div class="line"> </div>
<div class="line">        sequence seq(connection_string, sb_entity,</div>
<div class="line">                     connection_options()</div>
<div class="line">                     .user(sb_key_name)</div>
<div class="line">                     .password(sb_key)</div>
<div class="line">                     .sasl_allowed_mechs(<span class="stringliteral">&quot;PLAIN&quot;</span>));</div>
<div class="line">        <a class="code hl_class" href="classproton_1_1container.html">proton::container</a>(seq).<a id="a42" name="a42"></a><a class="code hl_function" href="classproton_1_1container.html#a13a43e6d814de94978c515cb084873b1">run</a>();</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="ttc" id="aclassproton_1_1connection__options_html"><div class="ttname"><a href="classproton_1_1connection__options.html">proton::connection_options</a></div><div class="ttdoc">Options for creating a connection.</div><div class="ttdef"><b>Definition:</b> connection_options.hpp:67</div></div>
<div class="ttc" id="aclassproton_1_1connection_html"><div class="ttname"><a href="classproton_1_1connection.html">proton::connection</a></div><div class="ttdoc">A connection to a remote AMQP peer.</div><div class="ttdef"><b>Definition:</b> connection.hpp:47</div></div>
<div class="ttc" id="aclassproton_1_1connection_html_a5ae591df94fc66ccb85cbb6565368bca"><div class="ttname"><a href="classproton_1_1connection.html#a5ae591df94fc66ccb85cbb6565368bca">proton::connection::close</a></div><div class="ttdeci">void close()</div><div class="ttdoc">Close the connection.</div></div>
<div class="ttc" id="aclassproton_1_1connection_html_a9cabc5284b3663af85c596e36669df15"><div class="ttname"><a href="classproton_1_1connection.html#a9cabc5284b3663af85c596e36669df15">proton::connection::work_queue</a></div><div class="ttdeci">class work_queue &amp; work_queue() const</div><div class="ttdoc">Get the work_queue for the connection.</div></div>
<div class="ttc" id="aclassproton_1_1connection_html_aad60d14592ee9d34caca4c61214ecd27"><div class="ttname"><a href="classproton_1_1connection.html#aad60d14592ee9d34caca4c61214ecd27">proton::connection::open_receiver</a></div><div class="ttdeci">receiver open_receiver(const std::string &amp;addr)</div><div class="ttdoc">Open a receiver for addr on default_session().</div></div>
<div class="ttc" id="aclassproton_1_1container_html"><div class="ttname"><a href="classproton_1_1container.html">proton::container</a></div><div class="ttdoc">A top-level container of connections, sessions, and links.</div><div class="ttdef"><b>Definition:</b> container.hpp:50</div></div>
<div class="ttc" id="aclassproton_1_1container_html_a13a43e6d814de94978c515cb084873b1"><div class="ttname"><a href="classproton_1_1container.html#a13a43e6d814de94978c515cb084873b1">proton::container::run</a></div><div class="ttdeci">void run()</div><div class="ttdoc">Run the container in the current thread.</div></div>
<div class="ttc" id="aclassproton_1_1container_html_a80a4c60eeadcd79041a19b5133af0cff"><div class="ttname"><a href="classproton_1_1container.html#a80a4c60eeadcd79041a19b5133af0cff">proton::container::open_sender</a></div><div class="ttdeci">returned&lt; sender &gt; open_sender(const std::string &amp;addr_url)</div><div class="ttdoc">Open a connection and sender for addr_url.</div></div>
<div class="ttc" id="aclassproton_1_1container_html_afc1b194266160cf854c5cbb8eeab4219"><div class="ttname"><a href="classproton_1_1container.html#afc1b194266160cf854c5cbb8eeab4219">proton::container::connect</a></div><div class="ttdeci">returned&lt; connection &gt; connect(const std::string &amp;conn_url, const connection_options &amp;conn_opts)</div><div class="ttdoc">Connect to conn_url and send an open request to the remote peer.</div></div>
<div class="ttc" id="aclassproton_1_1delivery_html"><div class="ttname"><a href="classproton_1_1delivery.html">proton::delivery</a></div><div class="ttdoc">A received message.</div><div class="ttdef"><b>Definition:</b> delivery.hpp:40</div></div>
<div class="ttc" id="aclassproton_1_1duration_html"><div class="ttname"><a href="classproton_1_1duration.html">proton::duration</a></div><div class="ttdoc">A span of time in milliseconds.</div><div class="ttdef"><b>Definition:</b> duration.hpp:39</div></div>
<div class="ttc" id="aclassproton_1_1link_html_a5ae591df94fc66ccb85cbb6565368bca"><div class="ttname"><a href="classproton_1_1link.html#a5ae591df94fc66ccb85cbb6565368bca">proton::link::close</a></div><div class="ttdeci">void close()</div><div class="ttdoc">Close the endpoint.</div></div>
<div class="ttc" id="aclassproton_1_1link_html_a9cabc5284b3663af85c596e36669df15"><div class="ttname"><a href="classproton_1_1link.html#a9cabc5284b3663af85c596e36669df15">proton::link::work_queue</a></div><div class="ttdeci">class work_queue &amp; work_queue() const</div><div class="ttdoc">Get the work_queue for the link.</div></div>
<div class="ttc" id="aclassproton_1_1link_html_afd27bd11ba72d7df51c44f71b15749eb"><div class="ttname"><a href="classproton_1_1link.html#afd27bd11ba72d7df51c44f71b15749eb">proton::link::credit</a></div><div class="ttdeci">int credit() const</div><div class="ttdoc">Credit available on the link.</div></div>
<div class="ttc" id="aclassproton_1_1link_html_aff302bb6016f2ae29f01bb4e07389a52"><div class="ttname"><a href="classproton_1_1link.html#aff302bb6016f2ae29f01bb4e07389a52">proton::link::connection</a></div><div class="ttdeci">class connection connection() const</div><div class="ttdoc">The connection that owns this link.</div></div>
<div class="ttc" id="aclassproton_1_1map_html"><div class="ttname"><a href="classproton_1_1map.html">proton::map&lt; symbol, value &gt;</a></div></div>
<div class="ttc" id="aclassproton_1_1map_html_aa5c42da16d5df4154dc8af4c39fbd8e0"><div class="ttname"><a href="classproton_1_1map.html#aa5c42da16d5df4154dc8af4c39fbd8e0">proton::map::get</a></div><div class="ttdeci">T get(const K &amp;k) const</div><div class="ttdoc">Get the map entry for key k.</div></div>
<div class="ttc" id="aclassproton_1_1map_html_ac310ae7d64b7ad8a70b200c07a55a736"><div class="ttname"><a href="classproton_1_1map.html#ac310ae7d64b7ad8a70b200c07a55a736">proton::map::put</a></div><div class="ttdeci">void put(const K &amp;k, const T &amp;v)</div><div class="ttdoc">Put a map entry for key k.</div></div>
<div class="ttc" id="aclassproton_1_1message_html"><div class="ttname"><a href="classproton_1_1message.html">proton::message</a></div><div class="ttdoc">An AMQP message.</div><div class="ttdef"><b>Definition:</b> message.hpp:48</div></div>
<div class="ttc" id="aclassproton_1_1message_html_ac203a412f35c34fce9de3016a9d57fb4"><div class="ttname"><a href="classproton_1_1message.html#ac203a412f35c34fce9de3016a9d57fb4">proton::message::group_id</a></div><div class="ttdeci">void group_id(const std::string &amp;)</div><div class="ttdoc">Set the message group ID.</div></div>
<div class="ttc" id="aclassproton_1_1message_html_ae9af642f154a68ec0eb8e715ecaf95ae"><div class="ttname"><a href="classproton_1_1message.html#ae9af642f154a68ec0eb8e715ecaf95ae">proton::message::body</a></div><div class="ttdeci">void body(const value &amp;x)</div><div class="ttdoc">Set the body. Equivalent to body() = x.</div></div>
<div class="ttc" id="aclassproton_1_1messaging__handler_html"><div class="ttname"><a href="classproton_1_1messaging__handler.html">proton::messaging_handler</a></div><div class="ttdoc">Handler for Proton messaging events.</div><div class="ttdef"><b>Definition:</b> messaging_handler.hpp:69</div></div>
<div class="ttc" id="aclassproton_1_1messaging__handler_html_a41277abe0e33a3df2764b08dcc12d768"><div class="ttname"><a href="classproton_1_1messaging__handler.html#a41277abe0e33a3df2764b08dcc12d768">proton::messaging_handler::on_connection_open</a></div><div class="ttdeci">virtual void on_connection_open(connection &amp;)</div><div class="ttdoc">The remote peer opened the connection: called once on initial open, and again on each successful auto...</div></div>
<div class="ttc" id="aclassproton_1_1messaging__handler_html_a4e61812588fe6fbde253b41f7c02e993"><div class="ttname"><a href="classproton_1_1messaging__handler.html#a4e61812588fe6fbde253b41f7c02e993">proton::messaging_handler::on_tracker_accept</a></div><div class="ttdeci">virtual void on_tracker_accept(tracker &amp;)</div><div class="ttdoc">The receiving peer accepted a transfer.</div></div>
<div class="ttc" id="aclassproton_1_1messaging__handler_html_a584c9daeadf4322801f58e054017fecb"><div class="ttname"><a href="classproton_1_1messaging__handler.html#a584c9daeadf4322801f58e054017fecb">proton::messaging_handler::on_message</a></div><div class="ttdeci">virtual void on_message(delivery &amp;, message &amp;)</div><div class="ttdoc">A message is received.</div></div>
<div class="ttc" id="aclassproton_1_1messaging__handler_html_a77f7e38659ee43ccb764e417ad6dd401"><div class="ttname"><a href="classproton_1_1messaging__handler.html#a77f7e38659ee43ccb764e417ad6dd401">proton::messaging_handler::on_receiver_open</a></div><div class="ttdeci">virtual void on_receiver_open(receiver &amp;)</div><div class="ttdoc">The remote peer opened the link.</div></div>
<div class="ttc" id="aclassproton_1_1messaging__handler_html_a86c9509ba3ce1925150c5b7a9a937c94"><div class="ttname"><a href="classproton_1_1messaging__handler.html#a86c9509ba3ce1925150c5b7a9a937c94">proton::messaging_handler::on_sendable</a></div><div class="ttdeci">virtual void on_sendable(sender &amp;)</div><div class="ttdoc">A message can be sent.</div></div>
<div class="ttc" id="aclassproton_1_1receiver__options_html"><div class="ttname"><a href="classproton_1_1receiver__options.html">proton::receiver_options</a></div><div class="ttdoc">Options for creating a receiver.</div><div class="ttdef"><b>Definition:</b> receiver_options.hpp:59</div></div>
<div class="ttc" id="aclassproton_1_1receiver_html"><div class="ttname"><a href="classproton_1_1receiver.html">proton::receiver</a></div><div class="ttdoc">A channel for receiving messages.</div><div class="ttdef"><b>Definition:</b> receiver.hpp:41</div></div>
<div class="ttc" id="aclassproton_1_1receiver_html_a91a9e8a9445b29d83dd0514cd76503ae"><div class="ttname"><a href="classproton_1_1receiver.html#a91a9e8a9445b29d83dd0514cd76503ae">proton::receiver::source</a></div><div class="ttdeci">class source source() const</div><div class="ttdoc">Get the source node.</div></div>
<div class="ttc" id="aclassproton_1_1sender__options_html"><div class="ttname"><a href="classproton_1_1sender__options.html">proton::sender_options</a></div><div class="ttdoc">Options for creating a sender.</div><div class="ttdef"><b>Definition:</b> sender_options.hpp:60</div></div>
<div class="ttc" id="aclassproton_1_1sender_html"><div class="ttname"><a href="classproton_1_1sender.html">proton::sender</a></div><div class="ttdoc">A channel for sending messages.</div><div class="ttdef"><b>Definition:</b> sender.hpp:40</div></div>
<div class="ttc" id="aclassproton_1_1sender_html_a214eb30b24e6831d016a47b9dddda830"><div class="ttname"><a href="classproton_1_1sender.html#a214eb30b24e6831d016a47b9dddda830">proton::sender::send</a></div><div class="ttdeci">tracker send(const message &amp;m)</div><div class="ttdoc">Send a message on the sender.</div></div>
<div class="ttc" id="aclassproton_1_1source__options_html"><div class="ttname"><a href="classproton_1_1source__options.html">proton::source_options</a></div><div class="ttdoc">Options for creating a source node for a sender or receiver.</div><div class="ttdef"><b>Definition:</b> source_options.hpp:46</div></div>
<div class="ttc" id="aclassproton_1_1source_html_af0e7ab5c3f8afb151ab76120a9607a22"><div class="ttname"><a href="classproton_1_1source.html#af0e7ab5c3f8afb151ab76120a9607a22">proton::source::filters</a></div><div class="ttdeci">const filter_map &amp; filters() const</div><div class="ttdoc">Unsettled API - Obtain the set of message filters.</div></div>
<div class="ttc" id="aclassproton_1_1ssl__client__options_html"><div class="ttname"><a href="classproton_1_1ssl__client__options.html">proton::ssl_client_options</a></div><div class="ttdoc">Unsettled API - SSL configuration for outbound connections.</div><div class="ttdef"><b>Definition:</b> ssl.hpp:153</div></div>
<div class="ttc" id="aclassproton_1_1symbol_html"><div class="ttname"><a href="classproton_1_1symbol.html">proton::symbol</a></div><div class="ttdoc">A string that represents the AMQP symbol type.</div><div class="ttdef"><b>Definition:</b> symbol.hpp:35</div></div>
<div class="ttc" id="aclassproton_1_1timestamp_html"><div class="ttname"><a href="classproton_1_1timestamp.html">proton::timestamp</a></div><div class="ttdoc">A 64-bit timestamp in milliseconds since the Unix epoch.</div><div class="ttdef"><b>Definition:</b> timestamp.hpp:35</div></div>
<div class="ttc" id="aclassproton_1_1timestamp_html_a8a432817c74685a518a08ede48d1db34"><div class="ttname"><a href="classproton_1_1timestamp.html#a8a432817c74685a518a08ede48d1db34">proton::timestamp::now</a></div><div class="ttdeci">static timestamp now()</div><div class="ttdoc">The current wall-clock time.</div></div>
<div class="ttc" id="aclassproton_1_1tracker_html"><div class="ttname"><a href="classproton_1_1tracker.html">proton::tracker</a></div><div class="ttdoc">A tracker for a sent message.</div><div class="ttdef"><b>Definition:</b> tracker.hpp:41</div></div>
<div class="ttc" id="aclassproton_1_1tracker_html_af6557049c84db2e028dce1b646d2e379"><div class="ttname"><a href="classproton_1_1tracker.html#af6557049c84db2e028dce1b646d2e379">proton::tracker::sender</a></div><div class="ttdeci">class sender sender() const</div><div class="ttdoc">Get the sender for this tracker.</div></div>
<div class="ttc" id="aclassproton_1_1value_html"><div class="ttname"><a href="classproton_1_1value.html">proton::value</a></div><div class="ttdoc">A holder for any AMQP value, simple or complex.</div><div class="ttdef"><b>Definition:</b> value.hpp:57</div></div>
<div class="ttc" id="aclassproton_1_1work__queue_html_a214d82f5924296d6fddbb8b150f8b601"><div class="ttname"><a href="classproton_1_1work__queue.html#a214d82f5924296d6fddbb8b150f8b601">proton::work_queue::schedule</a></div><div class="ttdeci">void schedule(duration, work fn)</div><div class="ttdoc">Unsettled API - Add work fn to the work queue after a duration.</div></div>
<div class="ttc" id="aconnection_8hpp_html"><div class="ttname"><a href="connection_8hpp.html">connection.hpp</a></div><div class="ttdoc">A connection to a remote AMQP peer.</div></div>
<div class="ttc" id="aconnection__options_8hpp_html"><div class="ttname"><a href="connection__options_8hpp.html">connection_options.hpp</a></div><div class="ttdoc">Options for creating a connection.</div></div>
<div class="ttc" id="acontainer_8hpp_html"><div class="ttname"><a href="container_8hpp.html">container.hpp</a></div><div class="ttdoc">A top-level container of connections, sessions, and links.</div></div>
<div class="ttc" id="adelivery_8hpp_html"><div class="ttname"><a href="delivery_8hpp.html">delivery.hpp</a></div><div class="ttdoc">A received message.</div></div>
<div class="ttc" id="amessage_8hpp_html"><div class="ttname"><a href="message_8hpp.html">message.hpp</a></div><div class="ttdoc">An AMQP message.</div></div>
<div class="ttc" id="amessaging__handler_8hpp_html"><div class="ttname"><a href="messaging__handler_8hpp.html">messaging_handler.hpp</a></div><div class="ttdoc">Handler for Proton messaging events.</div></div>
<div class="ttc" id="areceiver__options_8hpp_html"><div class="ttname"><a href="receiver__options_8hpp.html">receiver_options.hpp</a></div><div class="ttdoc">Options for creating a receiver.</div></div>
<div class="ttc" id="asender_8hpp_html"><div class="ttname"><a href="sender_8hpp.html">sender.hpp</a></div><div class="ttdoc">A channel for sending messages.</div></div>
<div class="ttc" id="asender__options_8hpp_html"><div class="ttname"><a href="sender__options_8hpp.html">sender_options.hpp</a></div><div class="ttdoc">Options for creating a sender.</div></div>
<div class="ttc" id="asource__options_8hpp_html"><div class="ttname"><a href="source__options_8hpp.html">source_options.hpp</a></div><div class="ttdoc">Options for creating a source node for a sender or receiver.</div></div>
<div class="ttc" id="assl_8hpp_html"><div class="ttname"><a href="ssl_8hpp.html">ssl.hpp</a></div><div class="ttdoc">SSL information.</div></div>
<div class="ttc" id="atracker_8hpp_html"><div class="ttname"><a href="tracker_8hpp.html">tracker.hpp</a></div><div class="ttdoc">A tracker for a sent message.</div></div>
<div class="ttc" id="awork__queue_8hpp_html"><div class="ttname"><a href="work__queue_8hpp.html">work_queue.hpp</a></div><div class="ttdoc">Unsettled API - A context for thread-safe execution of work.</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
